1.  select ename, job from emp where mgr is null;
2.  select prodid, amount, amount*1.005 as new_price, (amount*1.005-amount) as difference from sales;
3.  select * from emp where hiredate=(select hiredate from emp where ename='king');
4.  select max(sal)-(select sal from emp where deptno=10 limit 1) as difference from emp;
5.  select abs((select avg(sal) from emp where deptno=20)-(select avg(sal) from emp where deptno=30)) as difference;
6.  select ename, sal, comm from emp where comm>0.05*sal;
7.  select * from emp where sal<(select avg(sal) from emp where deptno=20);
8.  select * from emp where empno not in (select distinct mgr from emp where mgr is not null);
9.  select * from emp where empno=(select mgr from emp group by mgr order by count(*) desc limit 1);
10. select concat(empno,' ',ename,' ',mgr) as details from emp;
11. select * from emp order by hiredate asc limit 1; select * from emp order by hiredate desc limit 1;
12. select max(char_length(ename)) as longest, max(char_length(ename))-(select max(char_length(ename)) from emp where char_length(ename)<(select max(char_length(ename)) from emp)) as difference from emp;
13. select * from emp where sal<0.3*(select sal from emp where job='president');
14. select deptno from emp group by deptno order by sum(sal) desc limit 1;
15. select deptno from emp group by deptno order by count(*) asc limit 1;
16. select deptno from emp group by deptno having avg(sal) not in ((select max(avg_sal) from (select avg(sal) as avg_sal from emp group by deptno) t),(select min(avg_sal) from (select avg(sal) as avg_sal from emp group by deptno) t));
17. select * from emp where ename='ford';
18. select * from emp where hiredate<(select hiredate from emp where ename='blake');
19. select * from emp e where hiredate<(select min(hiredate) from emp where mgr=e.empno);
20. select * from emp where sal=(select max(sal) from emp);
21. select e.empno, e.ename, e.deptno from emp e where e.deptno=10 and e.empno in (select distinct mgr from emp where mgr is not null);
22. select year(hiredate) as year, count(*) as num from emp group by year(hiredate) order by num desc limit 1;
23. select e.empno, e.ename, e.job, e.mgr, m.job as mgr_job from emp e join emp m on e.mgr=m.empno;
24. select * from emp where empno=(select mgr from emp group by mgr order by count(*) desc limit 1);
25. select * from emp where mgr=(select empno from emp where ename='blake');
26. select deptno from emp where job='clerk' group by deptno having count(*)>1;
27. select * from emp where sal<0.3*(select sal from emp where job='president');
28. select e.ename, d.location from emp e join dept d on e.deptno=d.deptno where d.location<>'chicago';
29. select deptno from dept where deptno not in (select distinct deptno from emp);
30. select distinct prodname from sales where custname='jock sports' and prodname not in (select prodname from sales where custname='just tennis');
31. select * from emp e where hiredate=(select min(hiredate) from emp where deptno=e.deptno);
32. select ename, hiredate, sal from emp where (sal,comm)=(select sal,comm from emp where ename='scott');
33. select * from emp where empno in (select distinct mgr from emp where mgr is not null);
34. select e.ename as employee, m.ename as manager from emp e join emp m on e.mgr=m.empno;
35. select * from emp where empno not in (select distinct mgr from emp where mgr is not null);
36. select *, case when hiredate=(select max(hiredate) from emp) then '*' else '' end as marker from emp;
37. select * from emp e where sal>(select avg(sal) from emp where deptno=e.deptno);
38. select max(sal) as second_max from emp where sal<(select max(sal) from emp);
39. select empno, ename, count(*) from emp group by empno,ename having count(*)>1;
40. select * from emp where deptno=10 and ename<>'king';
